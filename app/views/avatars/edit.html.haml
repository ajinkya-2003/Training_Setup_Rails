-# frozen_string_literal: true

.container.mt-5
  %h2.text-center.mb-4 Update Your Avatar

  .text-center.mb-3
    %p Current Avatar:

    - if current_user.avatar.attached?
      - begin
        = image_tag current_user.avatar.variant(resize_to_limit: [150, 150]), class: "rounded"
      - rescue => e
        %p.text-danger Failed to render avatar variant: #{e.message}
        = image_tag url_for(current_user.avatar), class: "rounded"
    - else
      = image_tag "default_avatar.png", class: "rounded", width: 150, height: 150

  = form_with model: current_user, url: avatar_path, method: :put, local: true, html: { multipart: true } do |form|
    .mb-3
      = form.label :avatar, "Choose new avatar"
      = form.file_field :avatar, class: "form-control"

    .d-grid
      = form.submit "Update Avatar", class: "btn btn-success"

  - if current_user.avatar.attached?
    .mt-3.text-center
      = button_to "Remove Avatar", avatar_path, method: :delete, data: { confirm: "Are you sure?" }, class: "btn btn-outline-danger"
